<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>پیامرسان سعدی | Saadi Messenger</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* تمام استایل های قبلی شما اینجا کپی و قرار داده شوند */
        /* برای صرفه جویی در فضا، استایل های قبلی تکرار نمی شوند. */
        /* استایل های جدید برای پنل مدیریت: */
        
        .admin-panel {
            padding: 16px;
            background: var(--background-color);
            min-height: 100vh;
        }
        
        .admin-header {
            background: var(--secondary-color);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .admin-title {
            font-size: 1.5rem;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--primary-color);
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--secondary-color);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .admin-section {
            background: var(--secondary-color);
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .section-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .section-content {
            padding: 16px;
        }
        
        .user-list, .group-list, .channel-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .admin-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: var(--background-color);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .item-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .item-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }
        
        .item-details {
            display: flex;
            flex-direction: column;
        }
        
        .item-name {
            font-weight: 500;
            margin-bottom: 2px;
        }
        
        .item-id {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .verified-badge-admin {
            color: #1da1f2;
            font-size: 16px;
        }
        
        .admin-actions {
            display: flex;
            gap: 8px;
        }
        
        .admin-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .verify-btn {
            background: var(--primary-color);
            color: white;
        }
        
        .verify-btn:hover {
            background: #06a06b;
        }
        
        .revoke-btn {
            background: #e95d5d;
            color: white;
        }
        
        .revoke-btn:hover {
            background: #d44c4c;
        }
        
        .search-box-admin {
            width: 100%;
            padding: 12px 16px;
            background: var(--border-color);
            border: none;
            border-radius: 20px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 15px;
            outline: none;
            margin-bottom: 16px;
        }
        
        .admin-tabs {
            display: flex;
            background: var(--border-color);
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 20px;
        }
        
        .admin-tab {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 14px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .admin-tab.active {
            background: var(--primary-color);
            color: white;
        }
        
        .password-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 16px;
            backdrop-filter: blur(5px);
        }
        
        .password-content {
            background: var(--secondary-color);
            border-radius: 12px;
            padding: 20px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .password-title {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 16px;
            text-align: center;
        }
        
        .password-input {
            width: 100%;
            padding: 14px 16px;
            background: var(--border-color);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 15px;
            outline: none;
            margin-bottom: 16px;
        }
        
        .password-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }
        
        .empty-admin {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }
        
        .empty-admin-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <!-- صفحه اسپلش -->
    <div class="splash-screen" id="splash-screen">
        <div class="splash-content">
            <div class="splash-logo">
                <img src="https://cdn.imgurl.ir/uploads/d956431_33BCE89B-2F74-444C-8741-525AC2404090.png" alt="لوگوی پیامرسان سعدی">
            </div>
            <div class="splash-title">پیامرسان سعدی</div>
            <div class="splash-subtitle">Saadi Messenger</div>
        </div>
    </div>

    <!-- صفحه ورود -->
    <div class="auth-container hidden" id="auth-container">
        <div class="auth-header">
            <div class="auth-logo">
                <img src="https://cdn.imgurl.ir/uploads/d956431_33BCE89B-2F74-444C-8741-525AC2404090.png" alt="لوگوی پیامرسان سعدی">
            </div>
            <div class="auth-title">پیامرسان سعدی</div>
            <div class="auth-subtitle">به پیامرسان امن و سریع خوش آمدید</div>
        </div>
        
        <div class="auth-form">
            <div class="auth-tabs">
                <button class="auth-tab active" id="login-tab">ورود</button>
                <button class="auth-tab" id="register-tab">ثبت‌نام</button>
                <button class="auth-tab" id="phone-tab">ورود با شماره</button>
            </div>
            
            <div id="login-form">
                <input type="text" class="auth-input" id="login-username" placeholder="نام کاربری یا ایدی">
                <input type="password" class="auth-input" id="login-password" placeholder="رمز عبور">
                <button class="auth-button" id="login-btn">ورود به حساب</button>
            </div>
            
            <div id="register-form" class="hidden">
                <input type="text" class="auth-input" id="register-username" placeholder="نام کاربری جدید">
                <input type="text" class="auth-input" id="register-userid" placeholder="ایدی کاربری (مثال: user123)">
                <input type="tel" class="auth-input" id="register-phone" placeholder="شماره تلفن (اختیاری)">
                <input type="password" class="auth-input" id="register-password" placeholder="رمز عبور">
                <input type="password" class="auth-input" id="register-confirm" placeholder="تکرار رمز عبور">
                <button class="auth-button" id="register-btn">ایجاد حساب جدید</button>
            </div>
            
            <div id="phone-form" class="hidden">
                <input type="tel" class="auth-input" id="phone-number" placeholder="شماره تلفن (مثال: 09123456789)">
                <button class="auth-button" id="send-otp-btn">ارسال کد تأیید</button>
                <div id="otp-section" class="hidden">
                    <input type="text" class="auth-input" id="otp-code" placeholder="کد تأیید">
                    <button class="auth-button" id="verify-otp-btn">تأیید کد</button>
                </div>
            </div>
            
            <div class="auth-message" id="auth-message"></div>
            
            <!-- اطلاعات حساب‌های نمونه برای تست -->
            <div style="margin-top: 20px; padding: 15px; background: var(--border-color); border-radius: 10px; font-size: 12px;">
                <div style="margin-bottom: 10px; font-weight: bold;">حساب‌های نمونه برای تست:</div>
                <div>نام کاربری: <strong>admin</strong> | رمز: <strong>123456</strong></div>
                <div>نام کاربری: <strong>user1</strong> | رمز: <strong>123456</strong></div>
                <div>نام کاربری: <strong>user2</strong> | رمز: <strong>123456</strong></div>
                <div style="margin-top: 10px;">برای چت، از ایدی‌های: <strong>admin</strong>, <strong>user1</strong>, <strong>user2</strong>, <strong>botfather</strong> استفاده کنید</div>
            </div>
        </div>
    </div>

    <!-- صفحه اصلی -->
    <div class="messenger-container hidden" id="messenger-container">
        <!-- هدر -->
        <div class="header">
            <div class="header-title" id="header-title">چت‌ها</div>
            <div class="header-actions">
                <button class="header-btn" id="search-btn">
                    <i class="fas fa-search"></i>
                </button>
                <button class="header-btn" id="menu-btn">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
            </div>
        </div>

        <!-- منوی سه نقطه -->
        <div class="menu-dropdown hidden" id="menu-dropdown">
            <div class="menu-item" id="new-chat-menu">
                <div class="menu-icon">
                    <i class="fas fa-comment"></i>
                </div>
                <div class="menu-text">شروع چت جدید</div>
            </div>
            <div class="menu-item" id="create-group-menu">
                <div class="menu-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="menu-text">ایجاد گروه</div>
            </div>
            <div class="menu-item" id="create-channel-menu">
                <div class="menu-icon">
                    <i class="fas fa-bullhorn"></i>
                </div>
                <div class="menu-text">ایجاد کانال</div>
            </div>
        </div>

        <!-- محتوای اصلی -->
        <div class="main-content" id="main-content">
            <!-- لیست چت‌ها -->
            <div class="chats-list" id="chats-list">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div>هنوز چتی ندارید</div>
                    <div style="font-size: 14px; margin-top: 8px;">برای شروع چت جدید، روی دکمه ⋮ کلیک کنید</div>
                </div>
            </div>

            <!-- صفحه چت -->
            <div class="chat-container hidden" id="chat-container">
                <div class="chat-header">
                    <button class="header-btn" id="back-btn">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <div class="chat-avatar avatar-user" id="chat-header-avatar">
                        <i class="fas fa-user"></i>
                        <div class="online-status" id="chat-online-status"></div>
                    </div>
                    <div class="chat-header-info">
                        <div class="chat-with" id="chat-with">
                            چت
                            <i class="fas fa-check-circle verified-badge" id="chat-verified-badge"></i>
                        </div>
                        <div class="chat-status" id="chat-status">
                            <span id="status-text">آنلاین</span>
                            <span class="typing-indicator hidden" id="typing-indicator">در حال تایپ...</span>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="header-btn" id="voice-call-btn">
                            <i class="fas fa-phone"></i>
                        </button>
                        <button class="header-btn" id="video-call-btn">
                            <i class="fas fa-video"></i>
                        </button>
                        <button class="header-btn" id="chat-menu-btn">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>
                
                <div class="messages-container" id="messages-container">
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div>هنوز پیامی ارسال نشده</div>
                        <div style="font-size: 14px; margin-top: 8px;">اولین پیام را ارسال کنید!</div>
                    </div>
                </div>
                
                <div class="input-container">
                    <div class="message-input-container">
                        <div class="input-actions">
                            <button class="input-action" id="emoji-btn">
                                <i class="far fa-smile"></i>
                            </button>
                            <button class="input-action" id="attach-btn">
                                <i class="fas fa-paperclip"></i>
                            </button>
                        </div>
                        <textarea class="message-input" id="message-input" placeholder="پیام بنویسید..." rows="1"></textarea>
                        <div class="input-actions">
                            <button class="input-action" id="camera-btn">
                                <i class="fas fa-camera"></i>
                            </button>
                            <button class="input-action" id="mic-btn">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                    </div>
                    <button class="send-button" id="send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <!-- صفحه پروفایل -->
            <div class="profile-container hidden" id="profile-container">
                <div class="profile-header">
                    <button class="header-btn" id="back-from-profile-btn">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <div class="profile-avatar avatar-user" id="profile-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="profile-info">
                        <div class="profile-name" id="profile-name">
                            نام کاربر
                            <i class="fas fa-check-circle verified-badge" id="profile-verified-badge"></i>
                        </div>
                        <div class="profile-status" id="profile-status">آنلاین</div>
                    </div>
                </div>
                
                <div class="profile-content">
                    <div class="profile-section">
                        <div class="profile-item">
                            <div class="profile-label">آخرین بازدید</div>
                            <div class="profile-value" id="profile-last-seen">به تازگی</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">شماره</div>
                            <div class="profile-value" id="profile-number">68995-63/5/53</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-label">نام کاربری</div>
                            <div class="profile-value" id="profile-username">MMDhosein_FreeFire_Player</div>
                        </div>
                        <div class="profile-bio" id="profile-bio">
                            حرف های پشت سرم حرف نیست عقده است......
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <div class="profile-item">
                            <div class="profile-label">اعلان ها</div>
                            <div class="profile-value">فعال</div>
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <div class="profile-item" id="send-message-profile">
                            <div class="profile-label">ارسال پیام</div>
                            <div class="profile-value">
                                <i class="fas fa-chevron-left"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- صفحه تنظیمات -->
            <div class="settings-container hidden" id="settings-container">
                <div class="settings-section">
                    <div class="settings-item" id="profile-settings">
                        <div class="settings-icon">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="settings-text">
                            <div class="settings-title">پروفایل</div>
                            <div class="settings-desc">مدیریت حساب کاربری</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                    </div>
                    <div class="settings-item" id="privacy-settings">
                        <div class="settings-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <div class="settings-text">
                            <div class="settings-title">حریم خصوصی</div>
                            <div class="settings-desc">تنظیمات امنیتی</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <div class="settings-item" id="theme-settings">
                        <div class="settings-icon">
                            <i class="fas fa-moon"></i>
                        </div>
                        <div class="settings-text">
                            <div class="settings-title">تم شب</div>
                            <div class="settings-desc">فعال/غیرفعال</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                    </div>
                    <div class="settings-item" id="notification-settings">
                        <div class="settings-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="settings-text">
                            <div class="settings-title">اعلان‌ها</div>
                            <div class="settings-desc">مدیریت نوتیفیکیشن‌ها</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <div class="settings-item" id="help-settings">
                        <div class="settings-icon">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <div class="settings-text">
                            <div class="settings-title">راهنما</div>
                            <div class="settings-desc">راهنمای استفاده</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                    </div>
                    <div class="settings-item" id="logout-settings">
                        <div class="settings-icon">
                            <i class="fas fa-sign-out-alt"></i>
                        </div>
                        <div class="settings-text">
                            <div class="settings-title">خروج</div>
                            <div class="settings-desc">خروج از حساب کاربری</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                    </div>
                    <!-- آیتم پنل مدیریت اضافه شد -->
                    <div class="settings-item" id="admin-settings">
                        <div class="settings-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="settings-text">
                            <div class="settings-title">پنل مدیریت</div>
                            <div class="settings-desc">اعطای تیک آبی و مدیریت سیستم</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- صفحه ایجاد چت جدید -->
            <div class="new-chat-container hidden" id="new-chat-container">
                <div class="form-group">
                    <label class="form-label">ایدی کاربر مقابل</label>
                    <input type="text" class="form-input" id="new-chat-userid" placeholder="userid (بدون @)">
                </div>
                <div class="form-actions">
                    <button class="modal-btn secondary" id="cancel-new-chat">انصراف</button>
                    <button class="modal-btn primary" id="start-new-chat">شروع چت</button>
                </div>
                
                <!-- لیست کاربران موجود -->
                <div style="margin-top: 20px; padding: 15px; background: var(--border-color); border-radius: 10px;">
                    <div style="margin-bottom: 10px; font-weight: bold;">کاربران موجود:</div>
                    <div id="available-users-list"></div>
                </div>
            </div>

            <!-- صفحه ایجاد گروه -->
            <div class="create-form hidden" id="create-group-container">
                <div class="form-group">
                    <label class="form-label">نام گروه</label>
                    <input type="text" class="form-input" id="group-name" placeholder="نام گروه">
                </div>
                <div class="form-group">
                    <label class="form-label">ایدی گروه</label>
                    <input type="text" class="form-input" id="group-id" placeholder="groupid">
                </div>
                <div class="form-group">
                    <label class="form-label">بیوگرافی گروه</label>
                    <textarea class="form-textarea" id="group-bio" placeholder="توضیحاتی درباره گروه"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">عضو اول (ایدی کاربری)</label>
                    <input type="text" class="form-input" id="group-member" placeholder="userid">
                </div>
                <div class="form-actions">
                    <button class="modal-btn secondary" id="cancel-create-group">انصراف</button>
                    <button class="modal-btn primary" id="create-group">ایجاد گروه</button>
                </div>
            </div>

            <!-- صفحه ایجاد کانال -->
            <div class="create-form hidden" id="create-channel-container">
                <div class="form-group">
                    <label class="form-label">نام کانال</label>
                    <input type="text" class="form-input" id="channel-name" placeholder="نام کانال">
                </div>
                <div class="form-group">
                    <label class="form-label">ایدی کانال</label>
                    <input type="text" class="form-input" id="channel-id" placeholder="channelid">
                </div>
                <div class="form-group">
                    <label class="form-label">بیوگرافی کانال</label>
                    <textarea class="form-textarea" id="channel-bio" placeholder="توضیحاتی درباره کانال"></textarea>
                </div>
                <div class="form-actions">
                    <button class="modal-btn secondary" id="cancel-create-channel">انصراف</button>
                    <button class="modal-btn primary" id="create-channel">ایجاد کانال</button>
                </div>
            </div>

            <!-- پنل مدیریت -->
            <div class="admin-panel hidden" id="admin-panel">
                <div class="admin-header">
                    <div class="admin-title">پنل مدیریت - اعطای تیک آبی</div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);">مدیریت تأیید هویت کاربران، گروه‌ها و کانال‌ها</div>
                </div>
                
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="total-users">0</div>
                        <div class="stat-label">کل کاربران</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="verified-users">0</div>
                        <div class="stat-label">کاربران تأیید شده</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-groups">0</div>
                        <div class="stat-label">گروه‌ها</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-channels">0</div>
                        <div class="stat-label">کانال‌ها</div>
                    </div>
                </div>
                
                <div class="admin-tabs">
                    <button class="admin-tab active" data-admin-tab="users">کاربران</button>
                    <button class="admin-tab" data-admin-tab="groups">گروه‌ها</button>
                    <button class="admin-tab" data-admin-tab="channels">کانال‌ها</button>
                </div>
                
                <input type="text" class="search-box-admin" id="admin-search" placeholder="جستجو در بین موارد...">
                
                <!-- بخش کاربران -->
                <div class="admin-section" id="users-section">
                    <div class="section-header">
                        <div class="section-title">مدیریت کاربران</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);" id="users-count">0 کاربر</div>
                    </div>
                    <div class="section-content">
                        <div class="user-list" id="users-list">
                            <!-- لیست کاربران اینجا نمایش داده می‌شود -->
                        </div>
                    </div>
                </div>
                
                <!-- بخش گروه‌ها -->
                <div class="admin-section hidden" id="groups-section">
                    <div class="section-header">
                        <div class="section-title">مدیریت گروه‌ها</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);" id="groups-count">0 گروه</div>
                    </div>
                    <div class="section-content">
                        <div class="group-list" id="groups-list">
                            <!-- لیست گروه‌ها اینجا نمایش داده می‌شود -->
                        </div>
                    </div>
                </div>
                
                <!-- بخش کانال‌ها -->
                <div class="admin-section hidden" id="channels-section">
                    <div class="section-header">
                        <div class="section-title">مدیریت کانال‌ها</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);" id="channels-count">0 کانال</div>
                    </div>
                    <div class="section-content">
                        <div class="channel-list" id="channels-list">
                            <!-- لیست کانال‌ها اینجا نمایش داده می‌شود -->
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="admin-btn verify-btn" onclick="showChatsList()">بازگشت به چت‌ها</button>
                </div>
            </div>
        </div>

        <!-- تب‌بار پایین -->
        <div class="tab-bar">
            <button class="tab-item active" data-tab="chats">
                <div class="tab-icon">
                    <i class="fas fa-comments"></i>
                </div>
                <div>چت‌ها</div>
            </button>
            <button class="tab-item" data-tab="status">
                <div class="tab-icon">
                    <i class="fas fa-circle"></i>
                </div>
                <div>استاتوس</div>
            </button>
            <button class="tab-item" data-tab="calls">
                <div class="tab-icon">
                    <i class="fas fa-phone"></i>
                </div>
                <div>تماس‌ها</div>
            </button>
            <button class="tab-item" data-tab="settings">
                <div class="tab-icon">
                    <i class="fas fa-cog"></i>
                </div>
                <div>تنظیمات</div>
            </button>
        </div>
    </div>

    <!-- مودال‌ها -->
    <div class="modal" id="profile-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ویرایش پروفایل</div>
                <button class="modal-close" onclick="hideModal('profile-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">نام کاربری</label>
                    <input type="text" class="form-input" id="edit-username" placeholder="نام کاربری">
                </div>
                <div class="form-group">
                    <label class="form-label">ایدی کاربری</label>
                    <input type="text" class="form-input" id="edit-userid" placeholder="ایدی">
                </div>
                <div class="form-group">
                    <label class="form-label">بیوگرافی</label>
                    <textarea class="form-textarea" id="edit-bio" placeholder="بیوگرافی"></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="hideModal('profile-modal')">انصراف</button>
                <button class="modal-btn primary" onclick="saveProfile()">ذخیره</button>
            </div>
        </div>
    </div>

    <div class="modal" id="privacy-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">تنظیمات حریم خصوصی</div>
                <button class="modal-close" onclick="hideModal('privacy-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">نمایش آخرین بازدید</label>
                    <select class="form-select" id="last-seen-privacy">
                        <option value="everyone">همه</option>
                        <option value="contacts">مخاطبین</option>
                        <option value="nobody">هیچکس</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">نمایش وضعیت آنلاین</label>
                    <select class="form-select" id="online-privacy">
                        <option value="everyone">همه</option>
                        <option value="contacts">مخاطبین</option>
                        <option value="nobody">هیچکس</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">نمایش عکس پروفایل</label>
                    <select class="form-select" id="profile-pic-privacy">
                        <option value="everyone">همه</option>
                        <option value="contacts">مخاطبین</option>
                        <option value="nobody">هیچکس</option>
                    </select>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="hideModal('privacy-modal')">انصراف</button>
                <button class="modal-btn primary" onclick="savePrivacySettings()">ذخیره</button>
            </div>
        </div>
    </div>

    <div class="modal" id="notification-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">تنظیمات اعلان‌ها</div>
                <button class="modal-close" onclick="hideModal('notification-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">اعلان‌های پیام</label>
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <span>فعال</span>
                        <label class="switch">
                            <input type="checkbox" id="message-notifications" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">اعلان‌های گروه</label>
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <span>فعال</span>
                        <label class="switch">
                            <input type="checkbox" id="group-notifications" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">اعلان‌های کانال</label>
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <span>فعال</span>
                        <label class="switch">
                            <input type="checkbox" id="channel-notifications" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">صدا</label>
                    <select class="form-select" id="notification-sound">
                        <option value="default">پیش‌فرض</option>
                        <option value="silent">بی‌صدا</option>
                        <option value="custom">سفارشی</option>
                    </select>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="hideModal('notification-modal')">انصراف</button>
                <button class="modal-btn primary" onclick="saveNotificationSettings()">ذخیره</button>
            </div>
        </div>
    </div>

    <div class="modal" id="logout-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">خروج از حساب</div>
                <button class="modal-close" onclick="hideModal('logout-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>آیا مطمئن هستید که می‌خواهید از حساب خود خارج شوید؟</p>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="hideModal('logout-modal')">انصراف</button>
                <button class="modal-btn primary" onclick="logout()">خروج</button>
            </div>
        </div>
    </div>

    <!-- مودال ورود به پنل مدیریت -->
    <div class="password-modal hidden" id="admin-login-modal">
        <div class="password-content">
            <div class="password-title">ورود به پنل مدیریت</div>
            <input type="password" class="password-input" id="admin-password" placeholder="رمز عبور مدیریت را وارد کنید">
            <div class="password-actions">
                <button class="admin-btn revoke-btn" onclick="hideAdminLogin()">انصراف</button>
                <button class="admin-btn verify-btn" onclick="verifyAdminPassword()">ورود</button>
            </div>
            <div style="text-align: center; margin-top: 16px; font-size: 0.8rem; color: var(--text-secondary);">
                رمز پیش‌فرض: <strong>admin123</strong>
            </div>
        </div>
    </div>

    <script>
        // داده‌های برنامه
        let currentUser = null;
        let currentChat = null;
        let chats = [];
        let messages = {};
        let users = [];
        let groups = [];
        let channels = [];
        let isTyping = false;
        let typingTimeout = null;
        let otpCode = null;

        // کلیدهای ذخیره‌سازی
        const STORAGE_KEYS = {
            USERS: 'saadi_messenger_users',
            CHATS: 'saadi_messenger_chats',
            MESSAGES: 'saadi_messenger_messages',
            CURRENT_USER: 'saadi_messenger_current_user',
            GROUPS: 'saadi_messenger_groups',
            CHANNELS: 'saadi_messenger_channels',
            SETTINGS: 'saadi_messenger_settings'
        };

        // المان‌های DOM
        const elements = {
            splash: document.getElementById('splash-screen'),
            auth: document.getElementById('auth-container'),
            messenger: document.getElementById('messenger-container'),
            loginForm: document.getElementById('login-form'),
            registerForm: document.getElementById('register-form'),
            phoneForm: document.getElementById('phone-form'),
            authMessage: document.getElementById('auth-message'),
            chatsList: document.getElementById('chats-list'),
            chatContainer: document.getElementById('chat-container'),
            messagesContainer: document.getElementById('messages-container'),
            settingsContainer: document.getElementById('settings-container'),
            newChatContainer: document.getElementById('new-chat-container'),
            createGroupContainer: document.getElementById('create-group-container'),
            createChannelContainer: document.getElementById('create-channel-container'),
            profileContainer: document.getElementById('profile-container'),
            mainContent: document.getElementById('main-content'),
            menuDropdown: document.getElementById('menu-dropdown'),
            messageInput: document.getElementById('message-input'),
            typingIndicator: document.getElementById('typing-indicator'),
            statusText: document.getElementById('status-text'),
            availableUsersList: document.getElementById('available-users-list')
        };

        // المان‌های DOM پنل مدیریت
        const adminElements = {
            panel: document.getElementById('admin-panel'),
            loginModal: document.getElementById('admin-login-modal'),
            passwordInput: document.getElementById('admin-password'),
            usersList: document.getElementById('users-list'),
            groupsList: document.getElementById('groups-list'),
            channelsList: document.getElementById('channels-list'),
            usersSection: document.getElementById('users-section'),
            groupsSection: document.getElementById('groups-section'),
            channelsSection: document.getElementById('channels-section'),
            searchInput: document.getElementById('admin-search')
        };

        // داده‌های پنل مدیریت
        let adminPassword = "admin123"; // رمز عبور پیش‌فرض
        let isAdminLoggedIn = false;

        // تنظیمات پیش‌فرض
        let appSettings = {
            theme: 'dark',
            notifications: {
                message: true,
                group: true,
                channel: true,
                sound: 'default'
            },
            privacy: {
                lastSeen: 'everyone',
                onlineStatus: 'everyone',
                profilePic: 'everyone'
            }
        };

        // توابع ذخیره‌سازی
        const storage = {
            // ذخیره داده‌ها
            set: (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (e) {
                    console.error('خطا در ذخیره‌سازی داده‌ها:', e);
                    return false;
                }
            },
            
            // بازیابی داده‌ها
            get: (key) => {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch (e) {
                    console.error('خطا در بازیابی داده‌ها:', e);
                    return null;
                }
            },
            
            // حذف داده‌ها
            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                    return true;
                } catch (e) {
                    console.error('خطا در حذف داده‌ها:', e);
                    return false;
                }
            }
        };

        // مقداردهی اولیه
        function init() {
            // بارگذاری داده‌های ذخیره شده
            loadStoredData();
            
            // ایجاد کاربران نمونه
            createSampleUsers();
            
            // پنهان کردن صفحه اسپلش بعد از 3 ثانیه
            setTimeout(() => {
                elements.splash.classList.add('hidden');
                
                // بررسی اگر کاربر قبلاً وارد شده است
                if (currentUser) {
                    showMessenger();
                } else {
                    showAuthScreen();
                }
            }, 2500);

            // رویدادهای تب‌های ورود/ثبت‌نام/شماره
            document.getElementById('login-tab').addEventListener('click', () => switchAuthTab('login'));
            document.getElementById('register-tab').addEventListener('click', () => switchAuthTab('register'));
            document.getElementById('phone-tab').addEventListener('click', () => switchAuthTab('phone'));
            
            // رویدادهای دکمه‌های ورود/ثبت‌نام
            document.getElementById('login-btn').addEventListener('click', login);
            document.getElementById('register-btn').addEventListener('click', register);
            document.getElementById('send-otp-btn').addEventListener('click', sendOtp);
            document.getElementById('verify-otp-btn').addEventListener('click', verifyOtp);
            
            // رویدادهای تب‌بار پایین
            document.querySelectorAll('.tab-item').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const tabName = e.currentTarget.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // رویدادهای دیگر
            document.getElementById('back-btn').addEventListener('click', showChatsList);
            document.getElementById('back-from-profile-btn').addEventListener('click', showChatsList);
            document.getElementById('send-btn').addEventListener('click', sendMessage);
            document.getElementById('message-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // رویداد تایپ کردن
            document.getElementById('message-input').addEventListener('input', handleTyping);
            
            // رویداد منو
            document.getElementById('menu-btn').addEventListener('click', toggleMenu);
            
            // رویدادهای منو
            document.getElementById('new-chat-menu').addEventListener('click', showNewChatForm);
            document.getElementById('create-group-menu').addEventListener('click', showCreateGroupForm);
            document.getElementById('create-channel-menu').addEventListener('click', showCreateChannelForm);
            
            // رویداد جستجو
            document.getElementById('search-btn').addEventListener('click', showSearch);
            
            // رویدادهای تنظیمات
            document.getElementById('profile-settings').addEventListener('click', () => showProfileModal());
            document.getElementById('privacy-settings').addEventListener('click', () => showModal('privacy-modal'));
            document.getElementById('theme-settings').addEventListener('click', toggleTheme);
            document.getElementById('notification-settings').addEventListener('click', () => showModal('notification-modal'));
            document.getElementById('help-settings').addEventListener('click', () => showHelp());
            document.getElementById('logout-settings').addEventListener('click', () => showModal('logout-modal'));
            
            // رویداد پنل مدیریت
            document.getElementById('admin-settings').addEventListener('click', showAdminLogin);
            
            // رویدادهای فرم‌های ایجاد
            document.getElementById('cancel-new-chat').addEventListener('click', showChatsList);
            document.getElementById('start-new-chat').addEventListener('click', startNewChat);
            
            document.getElementById('cancel-create-group').addEventListener('click', showChatsList);
            document.getElementById('create-group').addEventListener('click', createGroup);
            
            document.getElementById('cancel-create-channel').addEventListener('click', showChatsList);
            document.getElementById('create-channel').addEventListener('click', createChannel);
            
            // رویدادهای دکمه‌های چت
            document.getElementById('voice-call-btn').addEventListener('click', () => showMessage('تماس صوتی به زودی اضافه خواهد شد'));
            document.getElementById('video-call-btn').addEventListener('click', () => showMessage('تماس تصویری به زودی اضافه خواهد شد'));
            document.getElementById('emoji-btn').addEventListener('click', () => showMessage('امکانات ایموجی به زودی اضافه خواهد شد'));
            document.getElementById('attach-btn').addEventListener('click', () => showMessage('امکانات ارسال فایل به زودی اضافه خواهد شد'));
            document.getElementById('camera-btn').addEventListener('click', () => showMessage('امکانات دوربین به زودی اضافه خواهد شد'));
            document.getElementById('mic-btn').addEventListener('click', () => showMessage('امکانات ضبط صدا به زودی اضافه خواهد شد'));
            
            // رویداد نمایش پروفایل
            document.getElementById('chat-with').addEventListener('click', showProfile);
            document.getElementById('send-message-profile').addEventListener('click', () => {
                elements.profileContainer.classList.add('hidden');
                elements.chatContainer.classList.remove('hidden');
            });
            
            // تنظیم ارتفاع خودکار برای فیلد ورودی پیام
            setupAutoResizeTextarea();
            
            // بستن منو با کلیک خارج از آن
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.header-btn') && !e.target.closest('.menu-dropdown')) {
                    elements.menuDropdown.classList.add('hidden');
                }
                
                // بستن منوی پیام با کلیک خارج از آن
                if (!e.target.closest('.message-actions') && !e.target.closest('.message-menu')) {
                    document.querySelectorAll('.message-menu').forEach(menu => {
                        menu.remove();
                    });
                }
            });
            
            // فوکوس روی فیلد ورودی پیام هنگام باز کردن چت
            document.getElementById('message-input').addEventListener('focus', function() {
                // اسکرول به پایین هنگام فوکوس روی فیلد ورودی
                setTimeout(() => {
                    elements.messagesContainer.scrollTop = elements.messagesContainer.scrollHeight;
                }, 100);
            });
        }

        // نمایش فرم ورود به پنل مدیریت
        function showAdminLogin() {
            adminElements.loginModal.classList.remove('hidden');
            adminElements.passwordInput.value = '';
            adminElements.passwordInput.focus();
        }
        
        // پنهان کردن فرم ورود
        function hideAdminLogin() {
            adminElements.loginModal.classList.add('hidden');
        }
        
        // تأیید رمز عبور مدیریت
        function verifyAdminPassword() {
            const enteredPassword = adminElements.passwordInput.value;
            
            if (enteredPassword === adminPassword) {
                isAdminLoggedIn = true;
                hideAdminLogin();
                showAdminPanel();
            } else {
                showMessage('رمز عبور اشتباه است', 'error');
            }
        }
        
        // نمایش پنل مدیریت
        function showAdminPanel() {
            // پنهان کردن همه بخش‌ها
            elements.chatsList.classList.add('hidden');
            elements.chatContainer.classList.add('hidden');
            elements.settingsContainer.classList.add('hidden');
            elements.newChatContainer.classList.add('hidden');
            elements.createGroupContainer.classList.add('hidden');
            elements.createChannelContainer.classList.add('hidden');
            elements.profileContainer.classList.add('hidden');
            
            // نمایش پنل مدیریت
            adminElements.panel.classList.remove('hidden');
            document.getElementById('header-title').textContent = 'پنل مدیریت';
            
            // بارگذاری داده‌ها
            loadAdminData();
        }
        
        // بارگذاری داده‌های پنل مدیریت
        function loadAdminData() {
            updateAdminStats();
            loadUsersList();
            loadGroupsList();
            loadChannelsList();
            
            // تنظیم رویدادهای تب‌ها
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const tabName = e.currentTarget.getAttribute('data-admin-tab');
                    switchAdminTab(tabName);
                });
            });
            
            // تنظیم رویداد جستجو
            adminElements.searchInput.addEventListener('input', filterAdminItems);
        }
        
        // به‌روزرسانی آمار پنل مدیریت
        function updateAdminStats() {
            const totalUsers = users.length;
            const verifiedUsers = users.filter(user => user.verified).length;
            const totalGroups = groups.length;
            const totalChannels = channels.length;
            
            document.getElementById('total-users').textContent = totalUsers;
            document.getElementById('verified-users').textContent = verifiedUsers;
            document.getElementById('total-groups').textContent = totalGroups;
            document.getElementById('total-channels').textContent = totalChannels;
        }
        
        // بارگذاری لیست کاربران
        function loadUsersList() {
            adminElements.usersList.innerHTML = '';
            
            if (users.length === 0) {
                adminElements.usersList.innerHTML = `
                    <div class="empty-admin">
                        <div class="empty-admin-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>کاربری یافت نشد</div>
                    </div>
                `;
                document.getElementById('users-count').textContent = '0 کاربر';
                return;
            }
            
            let displayedUsers = 0;
            
            users.forEach(user => {
                // برای امنیت، کاربر جاری نمی‌تواند خودش را تأیید کند
                if (user.userid === currentUser.userid) return;
                
                displayedUsers++;
                
                const userElement = document.createElement('div');
                userElement.className = 'admin-item';
                userElement.innerHTML = `
                    <div class="item-info">
                        <div class="item-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="item-details">
                            <div class="item-name">
                                ${user.username}
                                ${user.verified ? '<i class="fas fa-check-circle verified-badge-admin"></i>' : ''}
                            </div>
                            <div class="item-id">${user.userid}</div>
                        </div>
                    </div>
                    <div class="admin-actions">
                        ${user.verified ? 
                            `<button class="admin-btn revoke-btn" onclick="revokeVerification('user', '${user.userid}')">لغو تأیید</button>` : 
                            `<button class="admin-btn verify-btn" onclick="grantVerification('user', '${user.userid}')">اعطای تیک آبی</button>`
                        }
                    </div>
                `;
                
                adminElements.usersList.appendChild(userElement);
            });
            
            document.getElementById('users-count').textContent = `${displayedUsers} کاربر`;
        }
        
        // بارگذاری لیست گروه‌ها
        function loadGroupsList() {
            adminElements.groupsList.innerHTML = '';
            
            if (groups.length === 0) {
                adminElements.groupsList.innerHTML = `
                    <div class="empty-admin">
                        <div class="empty-admin-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>گروهی یافت نشد</div>
                    </div>
                `;
                document.getElementById('groups-count').textContent = '0 گروه';
                return;
            }
            
            document.getElementById('groups-count').textContent = `${groups.length} گروه`;
            
            groups.forEach(group => {
                const groupElement = document.createElement('div');
                groupElement.className = 'admin-item';
                groupElement.innerHTML = `
                    <div class="item-info">
                        <div class="item-avatar" style="background: #667eea;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="item-details">
                            <div class="item-name">
                                ${group.name}
                                ${group.verified ? '<i class="fas fa-check-circle verified-badge-admin"></i>' : ''}
                            </div>
                            <div class="item-id">${group.id} | مالک: ${group.owner}</div>
                        </div>
                    </div>
                    <div class="admin-actions">
                        ${group.verified ? 
                            `<button class="admin-btn revoke-btn" onclick="revokeVerification('group', '${group.id}')">لغو تأیید</button>` : 
                            `<button class="admin-btn verify-btn" onclick="grantVerification('group', '${group.id}')">اعطای تیک آبی</button>`
                        }
                    </div>
                `;
                
                adminElements.groupsList.appendChild(groupElement);
            });
        }
        
        // بارگذاری لیست کانال‌ها
        function loadChannelsList() {
            adminElements.channelsList.innerHTML = '';
            
            if (channels.length === 0) {
                adminElements.channelsList.innerHTML = `
                    <div class="empty-admin">
                        <div class="empty-admin-icon">
                            <i class="fas fa-bullhorn"></i>
                        </div>
                        <div>کانالی یافت نشد</div>
                    </div>
                `;
                document.getElementById('channels-count').textContent = '0 کانال';
                return;
            }
            
            document.getElementById('channels-count').textContent = `${channels.length} کانال`;
            
            channels.forEach(channel => {
                const channelElement = document.createElement('div');
                channelElement.className = 'admin-item';
                channelElement.innerHTML = `
                    <div class="item-info">
                        <div class="item-avatar" style="background: #0088cc;">
                            <i class="fas fa-bullhorn"></i>
                        </div>
                        <div class="item-details">
                            <div class="item-name">
                                ${channel.name}
                                ${channel.verified ? '<i class="fas fa-check-circle verified-badge-admin"></i>' : ''}
                            </div>
                            <div class="item-id">${channel.id} | مالک: ${channel.owner}</div>
                        </div>
                    </div>
                    <div class="admin-actions">
                        ${channel.verified ? 
                            `<button class="admin-btn revoke-btn" onclick="revokeVerification('channel', '${channel.id}')">لغو تأیید</button>` : 
                            `<button class="admin-btn verify-btn" onclick="grantVerification('channel', '${channel.id}')">اعطای تیک آبی</button>`
                        }
                    </div>
                `;
                
                adminElements.channelsList.appendChild(channelElement);
            });
        }
        
        // تغییر تب در پنل مدیریت
        function switchAdminTab(tabName) {
            // به‌روزرسانی تب‌های فعال
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-admin-tab="${tabName}"]`).classList.add('active');
            
            // پنهان کردن همه بخش‌ها
            adminElements.usersSection.classList.add('hidden');
            adminElements.groupsSection.classList.add('hidden');
            adminElements.channelsSection.classList.add('hidden');
            
            // نمایش بخش انتخاب شده
            switch(tabName) {
                case 'users':
                    adminElements.usersSection.classList.remove('hidden');
                    break;
                case 'groups':
                    adminElements.groupsSection.classList.remove('hidden');
                    break;
                case 'channels':
                    adminElements.channelsSection.classList.remove('hidden');
                    break;
            }
        }
        
        // فیلتر کردن موارد در پنل مدیریت
        function filterAdminItems() {
            const searchTerm = adminElements.searchInput.value.toLowerCase();
            
            // فیلتر کاربران
            const userItems = adminElements.usersList.querySelectorAll('.admin-item');
            userItems.forEach(item => {
                const userName = item.querySelector('.item-name').textContent.toLowerCase();
                const userId = item.querySelector('.item-id').textContent.toLowerCase();
                const isVisible = userName.includes(searchTerm) || userId.includes(searchTerm);
                item.style.display = isVisible ? 'flex' : 'none';
            });
            
            // فیلتر گروه‌ها
            const groupItems = adminElements.groupsList.querySelectorAll('.admin-item');
            groupItems.forEach(item => {
                const groupName = item.querySelector('.item-name').textContent.toLowerCase();
                const groupId = item.querySelector('.item-id').textContent.toLowerCase();
                const isVisible = groupName.includes(searchTerm) || groupId.includes(searchTerm);
                item.style.display = isVisible ? 'flex' : 'none';
            });
            
            // فیلتر کانال‌ها
            const channelItems = adminElements.channelsList.querySelectorAll('.admin-item');
            channelItems.forEach(item => {
                const channelName = item.querySelector('.item-name').textContent.toLowerCase();
                const channelId = item.querySelector('.item-id').textContent.toLowerCase();
                const isVisible = channelName.includes(searchTerm) || channelId.includes(searchTerm);
                item.style.display = isVisible ? 'flex' : 'none';
            });
        }
        
        // اعطای تیک آبی
        function grantVerification(type, id) {
            let target;
            
            switch(type) {
                case 'user':
                    target = users.find(user => user.userid === id);
                    if (target) {
                        target.verified = true;
                        storage.set(STORAGE_KEYS.USERS, users);
                        showMessage(`تیک آبی به کاربر ${target.username} اعطا شد`, 'success');
                    }
                    break;
                    
                case 'group':
                    target = groups.find(group => group.id === id);
                    if (target) {
                        target.verified = true;
                        storage.set(STORAGE_KEYS.GROUPS, groups);
                        showMessage(`تیک آبی به گروه ${target.name} اعطا شد`, 'success');
                    }
                    break;
                    
                case 'channel':
                    target = channels.find(channel => channel.id === id);
                    if (target) {
                        target.verified = true;
                        storage.set(STORAGE_KEYS.CHANNELS, channels);
                        showMessage(`تیک آبی به کانال ${target.name} اعطا شد`, 'success');
                    }
                    break;
            }
            
            // به‌روزرسانی لیست‌ها
            loadUsersList();
            loadGroupsList();
            loadChannelsList();
            updateAdminStats();
        }
        
        // لغو تیک آبی
        function revokeVerification(type, id) {
            let target;
            
            switch(type) {
                case 'user':
                    target = users.find(user => user.userid === id);
                    if (target) {
                        target.verified = false;
                        storage.set(STORAGE_KEYS.USERS, users);
                        showMessage(`تیک آبی از کاربر ${target.username} لغو شد`, 'success');
                    }
                    break;
                    
                case 'group':
                    target = groups.find(group => group.id === id);
                    if (target) {
                        target.verified = false;
                        storage.set(STORAGE_KEYS.GROUPS, groups);
                        showMessage(`تیک آبی از گروه ${target.name} لغو شد`, 'success');
                    }
                    break;
                    
                case 'channel':
                    target = channels.find(channel => channel.id === id);
                    if (target) {
                        target.verified = false;
                        storage.set(STORAGE_KEYS.CHANNELS, channels);
                        showMessage(`تیک آبی از کانال ${target.name} لغو شد`, 'success');
                    }
                    break;
            }
            
            // به‌روزرسانی لیست‌ها
            loadUsersList();
            loadGroupsList();
            loadChannelsList();
            updateAdminStats();
        }

        // تمام توابع قبلی دیگر (setupAutoResizeTextarea, loadStoredData, createSampleUsers, showAuthScreen, showMessenger, switchAuthTab, showAuthMessage, showMessage, login, register, sendOtp, verifyOtp, switchTab, loadChats, loadAvailableUsers, openChat, getChatStatus, loadMessages, showMessageMenu, editMessage, deleteMessage, sendMessage, simulateBotReply, generateBotReply, simulateSupportReply, generateSupportReply, updateLastMessage, showChatsList, showNewChatForm, showCreateGroupForm, showCreateChannelForm, showProfile, startNewChat, createGroup, createChannel, showSearch, showModal, hideModal, showProfileModal, saveProfile, savePrivacySettings, saveNotificationSettings, showNotificationSettings, showHelp, toggleTheme, logout, handleTyping, formatTime, toggleMenu) اینجا باید کپی شوند.
        // به دلیل محدودیت طول پاسخ، این توابع تکرار نمی‌شوند.

        // راه‌اندازی برنامه
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>